# 用户与权限系统模块 - 业务概述

> **返回**: [文档首页](../../README.md)  
> **前端文档**: [用户与权限系统模块 - 前端文档](../frontend/user.md)  
> **后端文档**: [用户与权限系统模块 - 后端文档](../backend/user.md)

## 目录

- [1. 模块概述](#1-模块概述)
- [2. 核心业务概念](#2-核心业务概念)
- [3. 业务流程](#3-业务流程)
- [4. 业务规则](#4-业务规则)
- [5. 模块关联](#5-模块关联)
- [6. 详细文档链接](#6-详细文档链接)

---

## 1. 模块概述

### 1.1 模块定位

用户与权限系统模块是GWEN系统的基础模块，负责用户管理、角色权限管理和部门管理，为其他模块提供用户身份和权限控制基础。

### 1.2 核心业务功能

- **用户管理**: 用户注册、审核、信息管理
- **角色权限管理**: 角色定义和权限分配
- **部门层级管理**: 部门层级结构管理
- **用户对账**: 用户对账明细查看和统计

### 1.3 业务价值

- **身份管理**: 统一管理用户身份信息
- **权限控制**: 通过角色权限控制用户访问权限
- **组织管理**: 通过部门层级管理组织结构
- **财务透明**: 通过用户对账明细实现财务透明

---

## 2. 核心业务概念

### 2.1 用户状态

| 状态 | 状态值 | 说明 |
|------|--------|------|
| 正常 | 0 | 用户正常使用 |
| 待审核 | 2 | 用户申请待审核 |
| 已拒绝 | 3 | 用户申请被拒绝 |
| 待申请 | 4 | 用户待申请 |

### 2.2 角色权限

- **角色**: 一组权限的集合，如"开发者"、"管理员"等
- **权限**: 具体的操作权限，如"task:create"、"note:edit"等
- **角色映射**: 用户与角色的关联关系，一个用户可以有多个角色

### 2.3 部门层级

- **部门**: 组织结构的单位
- **层级关系**: 部门之间可以有上下级关系
- **用户归属**: 用户可以归属于某个部门

### 2.4 用户对账

- **对账明细**: 用户的所有财务交易记录
- **收支统计**: 用户的收入和支出统计
- **余额查询**: 用户各货币类型的余额

---

## 3. 业务流程

### 3.1 用户注册流程

```
1. 用户申请注册
   ↓
2. 填写用户信息
   - 账号
   - 显示名称
   ↓
3. 提交申请
   ↓
4. 状态变为"待审核"
   ↓
5. 管理员审核
   ↓
6. 审核结果：
   ├─ [通过] → 状态变为"正常"
   └─ [拒绝] → 状态变为"已拒绝"
```

### 3.2 角色权限分配流程

```
1. 管理员创建角色
   ↓
2. 为角色分配权限
   ↓
3. 将角色分配给用户
   ↓
4. 用户获得角色对应的权限
   ↓
5. 用户可以使用相应功能
```

### 3.3 用户对账流程

```
1. 用户查看对账明细
   ↓
2. 选择查询条件
   - 时间范围
   - 货币类型
   ↓
3. 获取对账明细
   ↓
4. 查看收支统计
   - 总收入
   - 总支出
   - 余额
```

---

## 4. 业务规则

### 4.1 用户管理规则

1. **账号唯一**: 用户账号必须唯一
2. **审核机制**: 新用户需要管理员审核
3. **状态流转**: 用户状态必须按照预定义流程流转
4. **信息更新**: 用户可以更新自己的信息（部分字段）

### 4.2 角色权限规则

1. **角色创建**: 只有管理员可以创建角色
2. **权限分配**: 只有管理员可以为角色分配权限
3. **用户分配**: 只有管理员可以将角色分配给用户
4. **权限继承**: 用户拥有所有角色的权限集合

### 4.3 部门管理规则

1. **层级结构**: 部门支持多级层级结构
2. **上级关系**: 用户可以设置上级用户
3. **部门归属**: 用户可以归属于某个部门

### 4.4 用户对账规则

1. **查看权限**: 用户只能查看自己的对账明细
2. **统计范围**: 对账统计包括所有货币类型
3. **时间筛选**: 支持按时间范围筛选对账明细

---

## 5. 模块关联

### 5.1 与任务系统关联

- 任务分配涉及用户（assignee/assignor）
- 任务权限基于用户角色
- 用户对账明细包含任务奖励记录

### 5.2 与财务系统关联

- 用户对账明细来自财务交易记录
- 用户余额统计基于财务账户

### 5.3 与其他模块关联

- 所有模块都依赖用户系统进行身份认证
- 所有模块都依赖权限系统进行权限控制

---

## 6. 详细文档链接

### 6.1 前端文档

详细的前端实现文档请参考：[用户与权限系统模块 - 前端文档](../frontend/user.md)

包含内容：
- 页面结构和路由
- 组件结构和说明
- Store 状态管理
- API 调用规范
- 交互流程
- UI 规范
- 权限控制

### 6.2 后端文档

详细的后端实现文档请参考：[用户与权限系统模块 - 后端文档](../backend/user.md)

包含内容：
- 数据模型（Model/Schema）
- API 规范（Controller/Route）
- 业务逻辑流程（Service/UseCase）
- 权限与鉴权规则
- 错误码和响应规范
- 定时任务/队列处理/事件

---

**文档版本**: v1.0  
**最后更新**: 2025-11-19  
**维护者**: GWEN开发团队
